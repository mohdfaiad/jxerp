 select
    ap_creditor.creditor_acct,
    ap_creditor.creditor_type,
    ap_creditor.address1,
    ap_creditor.address2,
    ap_creditor.address3,
    ap_creditor.short_name,
    ap_creditor.credit_term,
    ap_creditor.tax_registed_no,
    ap_creditor.province,
    ap_creditor.postcode,
    ap_creditor.th_addr1,
    ap_creditor.th_addr2,
    ap_creditor.th_addr3,
    ap_creditor.th_name,
    ap_payment_hd.doc_no,
    ap_payment_hd.doc_date,
    ap_payment_hd.trx_type,
    ap_payment_hd.ref_no,
    ap_payment_hd.ref_date,
    ap_payment_hd.descs,
    ap_payment_hd.remark,
    ap_payment_hd.bank_code,
    ap_payment_hd.currency_code,
    ap_payment_hd.bathtext,
    ap_payment_hd.status,
    ap_payment_dt.line_no,
    ap_payment_dt.invoice_no,
    ap_payment_dt.invoice_date,
    ap_payment_dt.line_descs,
    ap_payment_dt.line_remark,
    ap_payment_dt.tax_code,
    ap_payment_dt.tax_rate,
    ap_payment_dt.tax_amount,
    ap_payment_dt.whtax_code,
    ap_payment_dt.whtax_rate,
    ap_payment_dt.whtax_amount,
    ap_payment_dt.base_amount,
    ap_payment_dt.total_amount,
    company_profile.eng_name,
    company_profile.thai_name,
    company_profile.address1,
    company_profile.address2,
    company_profile.address3,
    company_profile.th_address1,
    company_profile.th_address2,
    company_profile.th_address3,
    company_profile.postcode,
    company_profile.province,
    company_profile.email,
    company_profile.website,
    company_profile.taxregistered_id,
    company_profile.telephone
from ap_payment_dt  ,company_profile
   inner join ap_payment_hd on (ap_payment_dt.doc_no = ap_payment_hd.doc_no) and (ap_payment_dt.doc_date = ap_payment_hd.doc_date) and (ap_payment_dt.trx_type = ap_payment_hd.trx_type) and (ap_payment_dt.creditor_acct = ap_payment_hd.creditor_acct)
   inner join ap_creditor on (ap_payment_hd.creditor_acct = ap_creditor.creditor_acct)
   AND (AP_PAYMENT_HD.status ='N' )
    WHERE (AP_PAYMENT_HD.DOC_NO =:PDOCNO  )
